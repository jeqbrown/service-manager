{% extends "admin/change_form.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}
    {{ block.super }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Only modify non-inline add buttons
            document.querySelectorAll('form#instrument_form .add-another, form#instrument_form .related-lookup').forEach(function(el) {
                // Skip if the element is within an inline form
                if (el.closest('.inline-related')) {
                    return;
                }
                
                el.removeAttribute('onclick');
                el.classList.remove('related-lookup');
                el.classList.remove('add-another');
                if (el.tagName === 'A') {
                    el.setAttribute('target', '_self');
                }
            });

            // Handle service history links
            document.querySelectorAll('.service-history a').forEach(function(el) {
                el.removeAttribute('target');
                el.removeAttribute('onclick');
            });
        });
    </script>
{% endblock %}
