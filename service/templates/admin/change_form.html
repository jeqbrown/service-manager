{% extends "admin/change_form.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}
    {{ block.super }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Remove popup behavior from all add buttons
            document.querySelectorAll('.add-another, .related-lookup').forEach(function(el) {
                el.removeAttribute('onclick');
                el.classList.remove('related-lookup');
                el.classList.remove('add-another');
                if (el.tagName === 'A') {
                    el.setAttribute('target', '_self');
                }
            });

            // Handle service history links
            document.querySelectorAll('.service-history a').forEach(function(el) {
                el.removeAttribute('target');
                el.removeAttribute('onclick');
            });

            // Override the RelatedObjectLookups.js functions
            if (typeof window.showRelatedObjectLookupPopup !== 'undefined') {
                window.showRelatedObjectLookupPopup = function(triggeringLink) {
                    window.location.href = triggeringLink.href;
                    return false;
                };
            }
            
            if (typeof window.showAddAnotherPopup !== 'undefined') {
                window.showAddAnotherPopup = function(triggeringLink) {
                    window.location.href = triggeringLink.href;
                    return false;
                };
            }
        });
    </script>
{% endblock %}
